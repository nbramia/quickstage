import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { Link } from 'react-router-dom';
export default function DashboardWidgets({ snapshots, onExtend }) {
    // Calculate metrics
    const activeSnapshots = snapshots.filter(s => new Date(s.expiresAt) > new Date());
    const expiringSoon = activeSnapshots.filter(s => {
        const days = Math.ceil((new Date(s.expiresAt).getTime() - Date.now()) / (1000 * 60 * 60 * 24));
        return days <= 3 && days > 0;
    });
    const reviewsPending = snapshots.filter(s => s.review?.isRequested && s.review.status === 'pending');
    const reviewsOverdue = snapshots.filter(s => s.review?.isRequested && s.review.status === 'overdue');
    const popularSnapshots = [...snapshots]
        .filter(s => s.viewCount > 0)
        .sort((a, b) => (b.viewCount || 0) - (a.viewCount || 0))
        .slice(0, 5);
    const recentActivity = [...snapshots]
        .filter(s => s.analytics?.recentViewers && s.analytics.recentViewers.length > 0)
        .slice(0, 5);
    return (_jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6", children: [_jsxs("div", { className: "bg-white rounded-xl shadow-sm border border-gray-200 p-4", children: [_jsxs("div", { className: "flex items-center justify-between mb-3", children: [_jsx("h3", { className: "text-sm font-semibold text-gray-900", children: "Review Status" }), _jsx("svg", { className: "w-5 h-5 text-gray-400", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" }) })] }), _jsxs("div", { className: "space-y-2", children: [reviewsPending.length > 0 && (_jsxs("div", { className: "flex items-center justify-between", children: [_jsx("span", { className: "text-sm text-gray-600", children: "Pending Reviews" }), _jsx("span", { className: "inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800", children: reviewsPending.length })] })), reviewsOverdue.length > 0 && (_jsxs("div", { className: "flex items-center justify-between", children: [_jsx("span", { className: "text-sm text-gray-600", children: "Overdue Reviews" }), _jsx("span", { className: "inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800", children: reviewsOverdue.length })] })), reviewsPending.length === 0 && reviewsOverdue.length === 0 && (_jsx("p", { className: "text-sm text-gray-500", children: "No pending reviews" })), (reviewsPending.length > 0 || reviewsOverdue.length > 0) && (_jsx("div", { className: "pt-2 mt-2 border-t border-gray-100", children: [...reviewsOverdue, ...reviewsPending].slice(0, 3).map(snapshot => (_jsx(Link, { to: `/viewer/${snapshot.id}`, className: "block py-1 text-sm text-indigo-600 hover:text-indigo-800 truncate", children: snapshot.name || `Snapshot ${snapshot.id.slice(0, 8)}` }, snapshot.id))) }))] })] }), _jsxs("div", { className: "bg-white rounded-xl shadow-sm border border-gray-200 p-4", children: [_jsxs("div", { className: "flex items-center justify-between mb-3", children: [_jsx("h3", { className: "text-sm font-semibold text-gray-900", children: "Expiring Soon" }), _jsx("svg", { className: "w-5 h-5 text-gray-400", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" }) })] }), expiringSoon.length > 0 ? (_jsx("div", { className: "space-y-2", children: expiringSoon.slice(0, 5).map(snapshot => {
                            const days = Math.ceil((new Date(snapshot.expiresAt).getTime() - Date.now()) / (1000 * 60 * 60 * 24));
                            return (_jsxs("div", { className: "flex items-center justify-between", children: [_jsx(Link, { to: `/viewer/${snapshot.id}`, className: "text-sm text-gray-700 hover:text-indigo-600 truncate flex-1 mr-2", children: snapshot.name || `Snapshot ${snapshot.id.slice(0, 8)}` }), _jsxs("div", { className: "flex items-center gap-2", children: [_jsxs("span", { className: `text-xs font-medium ${days <= 1 ? 'text-red-600' : 'text-orange-600'}`, children: [days, " day", days !== 1 ? 's' : ''] }), snapshot.viewCount > 0 && (_jsx("button", { onClick: () => onExtend(snapshot.id), className: "text-xs text-indigo-600 hover:text-indigo-800", children: "Extend" }))] })] }, snapshot.id));
                        }) })) : (_jsx("p", { className: "text-sm text-gray-500", children: "No snapshots expiring soon" }))] }), _jsxs("div", { className: "bg-white rounded-xl shadow-sm border border-gray-200 p-4", children: [_jsxs("div", { className: "flex items-center justify-between mb-3", children: [_jsx("h3", { className: "text-sm font-semibold text-gray-900", children: "Most Viewed" }), _jsx("svg", { className: "w-5 h-5 text-gray-400", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" }) })] }), popularSnapshots.length > 0 ? (_jsx("div", { className: "space-y-2", children: popularSnapshots.map(snapshot => (_jsxs("div", { className: "flex items-center justify-between", children: [_jsx(Link, { to: `/viewer/${snapshot.id}`, className: "text-sm text-gray-700 hover:text-indigo-600 truncate flex-1 mr-2", children: snapshot.name || `Snapshot ${snapshot.id.slice(0, 8)}` }), _jsxs("div", { className: "flex items-center gap-1", children: [_jsxs("svg", { className: "w-4 h-4 text-gray-400", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: [_jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M15 12a3 3 0 11-6 0 3 3 0 016 0z" }), _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" })] }), _jsx("span", { className: "text-xs text-gray-600", children: snapshot.viewCount })] })] }, snapshot.id))) })) : (_jsx("p", { className: "text-sm text-gray-500", children: "No views yet" }))] }), _jsxs("div", { className: "bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl shadow-sm p-4 text-white", children: [_jsx("h3", { className: "text-sm font-semibold mb-3", children: "Quick Stats" }), _jsxs("div", { className: "grid grid-cols-2 gap-3", children: [_jsxs("div", { children: [_jsx("p", { className: "text-2xl font-bold", children: activeSnapshots.length }), _jsx("p", { className: "text-xs opacity-90", children: "Active Snapshots" })] }), _jsxs("div", { children: [_jsx("p", { className: "text-2xl font-bold", children: snapshots.reduce((sum, s) => sum + (s.viewCount || 0), 0) }), _jsx("p", { className: "text-xs opacity-90", children: "Total Views" })] }), _jsxs("div", { children: [_jsx("p", { className: "text-2xl font-bold", children: snapshots.reduce((sum, s) => sum + (s.commentCount || 0), 0) }), _jsx("p", { className: "text-xs opacity-90", children: "Comments" })] }), _jsxs("div", { children: [_jsx("p", { className: "text-2xl font-bold", children: snapshots.filter(s => s.review?.isRequested).length }), _jsx("p", { className: "text-xs opacity-90", children: "Reviews" })] })] })] }), recentActivity.length > 0 && (_jsxs("div", { className: "bg-white rounded-xl shadow-sm border border-gray-200 p-4 md:col-span-2", children: [_jsxs("div", { className: "flex items-center justify-between mb-3", children: [_jsx("h3", { className: "text-sm font-semibold text-gray-900", children: "Recent Activity" }), _jsx("svg", { className: "w-5 h-5 text-gray-400", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" }) })] }), _jsx("div", { className: "space-y-2", children: recentActivity.map(snapshot => (_jsxs("div", { className: "flex items-center justify-between", children: [_jsx(Link, { to: `/viewer/${snapshot.id}`, className: "text-sm text-gray-700 hover:text-indigo-600 truncate flex-1 mr-2", children: snapshot.name || `Snapshot ${snapshot.id.slice(0, 8)}` }), _jsxs("span", { className: "text-xs text-gray-500", children: [snapshot.analytics?.recentViewers?.length, " recent viewer", snapshot.analytics?.recentViewers?.length !== 1 ? 's' : ''] })] }, snapshot.id))) })] }))] }));
}
